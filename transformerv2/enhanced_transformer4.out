nohup: ignoring input
使用设备: cuda:6
正在加载数据并添加时间特征...
训练集大小: 716
测试集大小: 657
特征列数量: 21
特征示例: ['Global_reactive_power', 'Voltage', 'Global_intensity', 'Sub_metering_1', 'Sub_metering_2']...
输入特征维度: 21
开始进行多次实验...

=== 实验 1/5 ===
训练短期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=128, nhead=8, num_layers=3
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/100], Train Loss: 0.083687, Val Loss: 0.031753, Test Loss: 0.024408 *
Epoch [2/100], Train Loss: 0.046723, Val Loss: 0.030770, Test Loss: 0.024215 *
Epoch [3/100], Train Loss: 0.037167, Val Loss: 0.032473, Test Loss: 0.021675
Epoch [4/100], Train Loss: 0.034362, Val Loss: 0.029424, Test Loss: 0.020344 *
Epoch [5/100], Train Loss: 0.032858, Val Loss: 0.025007, Test Loss: 0.020228 *
Epoch [6/100], Train Loss: 0.032013, Val Loss: 0.027033, Test Loss: 0.019931
Epoch [7/100], Train Loss: 0.032362, Val Loss: 0.027434, Test Loss: 0.019463
Epoch [8/100], Train Loss: 0.031023, Val Loss: 0.028950, Test Loss: 0.028396
Epoch [9/100], Train Loss: 0.032023, Val Loss: 0.035661, Test Loss: 0.025386
Epoch [10/100], Train Loss: 0.035558, Val Loss: 0.022426, Test Loss: 0.021035 *
Epoch [11/100], Train Loss: 0.061951, Val Loss: 0.036177, Test Loss: 0.025424
Epoch [12/100], Train Loss: 0.034909, Val Loss: 0.028097, Test Loss: 0.022041
Epoch [13/100], Train Loss: 0.029199, Val Loss: 0.028194, Test Loss: 0.019809
Epoch [14/100], Train Loss: 0.034041, Val Loss: 0.026540, Test Loss: 0.023386
Epoch [15/100], Train Loss: 0.030502, Val Loss: 0.022045, Test Loss: 0.021583 *
Epoch [16/100], Train Loss: 0.029925, Val Loss: 0.021057, Test Loss: 0.018245 *
Epoch [17/100], Train Loss: 0.029607, Val Loss: 0.021768, Test Loss: 0.019650
Epoch [18/100], Train Loss: 0.036146, Val Loss: 0.033788, Test Loss: 0.027055
Epoch [19/100], Train Loss: 0.032284, Val Loss: 0.030176, Test Loss: 0.028205
Epoch [20/100], Train Loss: 0.029604, Val Loss: 0.020808, Test Loss: 0.016930 *
Epoch [21/100], Train Loss: 0.030929, Val Loss: 0.048852, Test Loss: 0.050539
Epoch [22/100], Train Loss: 0.032592, Val Loss: 0.029911, Test Loss: 0.029819
Epoch [23/100], Train Loss: 0.037317, Val Loss: 0.020397, Test Loss: 0.017484 *
Epoch [24/100], Train Loss: 0.024915, Val Loss: 0.019455, Test Loss: 0.015936 *
Epoch [25/100], Train Loss: 0.022028, Val Loss: 0.020720, Test Loss: 0.017011
Epoch [26/100], Train Loss: 0.022738, Val Loss: 0.019969, Test Loss: 0.016374
Epoch [27/100], Train Loss: 0.021321, Val Loss: 0.024803, Test Loss: 0.023047
Epoch [28/100], Train Loss: 0.031201, Val Loss: 0.028982, Test Loss: 0.023028
Epoch [29/100], Train Loss: 0.023633, Val Loss: 0.019549, Test Loss: 0.016316
Epoch [30/100], Train Loss: 0.021773, Val Loss: 0.024360, Test Loss: 0.019237
Epoch [31/100], Train Loss: 0.020563, Val Loss: 0.020778, Test Loss: 0.018833
Epoch [32/100], Train Loss: 0.021464, Val Loss: 0.018133, Test Loss: 0.016954 *
Epoch [33/100], Train Loss: 0.018714, Val Loss: 0.023099, Test Loss: 0.018465
Epoch [34/100], Train Loss: 0.020771, Val Loss: 0.019693, Test Loss: 0.016425
Epoch [35/100], Train Loss: 0.019039, Val Loss: 0.023403, Test Loss: 0.018435
Epoch [36/100], Train Loss: 0.018995, Val Loss: 0.018626, Test Loss: 0.016209
Epoch [37/100], Train Loss: 0.019155, Val Loss: 0.022469, Test Loss: 0.025653
Epoch [38/100], Train Loss: 0.020080, Val Loss: 0.019546, Test Loss: 0.017582
Epoch [39/100], Train Loss: 0.016695, Val Loss: 0.052818, Test Loss: 0.040306
Epoch [40/100], Train Loss: 0.022376, Val Loss: 0.019903, Test Loss: 0.016607
Epoch [41/100], Train Loss: 0.018362, Val Loss: 0.024680, Test Loss: 0.020132
Epoch [42/100], Train Loss: 0.021623, Val Loss: 0.021338, Test Loss: 0.026665
Epoch [43/100], Train Loss: 0.021148, Val Loss: 0.017533, Test Loss: 0.022161 *
Epoch [44/100], Train Loss: 0.020115, Val Loss: 0.022143, Test Loss: 0.025359
Epoch [45/100], Train Loss: 0.016866, Val Loss: 0.019215, Test Loss: 0.020984
Epoch [46/100], Train Loss: 0.017171, Val Loss: 0.017618, Test Loss: 0.016136
Epoch [47/100], Train Loss: 0.016036, Val Loss: 0.017735, Test Loss: 0.017487
Epoch [48/100], Train Loss: 0.015231, Val Loss: 0.017379, Test Loss: 0.021537 *
Epoch [49/100], Train Loss: 0.016960, Val Loss: 0.018234, Test Loss: 0.016243
Epoch [50/100], Train Loss: 0.016367, Val Loss: 0.017175, Test Loss: 0.017047 *
Epoch [51/100], Train Loss: 0.015113, Val Loss: 0.015958, Test Loss: 0.018914 *
Epoch [52/100], Train Loss: 0.014746, Val Loss: 0.019530, Test Loss: 0.019925
Epoch [53/100], Train Loss: 0.015457, Val Loss: 0.016301, Test Loss: 0.016402
Epoch [54/100], Train Loss: 0.015988, Val Loss: 0.015165, Test Loss: 0.018426 *
Epoch [55/100], Train Loss: 0.014546, Val Loss: 0.016442, Test Loss: 0.020090
Epoch [56/100], Train Loss: 0.014339, Val Loss: 0.015428, Test Loss: 0.021878
Epoch [57/100], Train Loss: 0.014889, Val Loss: 0.015237, Test Loss: 0.018452
Epoch [58/100], Train Loss: 0.014217, Val Loss: 0.018698, Test Loss: 0.025167
Epoch [59/100], Train Loss: 0.015078, Val Loss: 0.014103, Test Loss: 0.017272 *
Epoch [60/100], Train Loss: 0.014174, Val Loss: 0.014104, Test Loss: 0.019200
Epoch [61/100], Train Loss: 0.012773, Val Loss: 0.015862, Test Loss: 0.018412
Epoch [62/100], Train Loss: 0.012941, Val Loss: 0.014029, Test Loss: 0.017804 *
Epoch [63/100], Train Loss: 0.013268, Val Loss: 0.014555, Test Loss: 0.017254
Epoch [64/100], Train Loss: 0.012976, Val Loss: 0.014693, Test Loss: 0.018166
Epoch [65/100], Train Loss: 0.012570, Val Loss: 0.014216, Test Loss: 0.019588
Epoch [66/100], Train Loss: 0.012468, Val Loss: 0.014272, Test Loss: 0.019893
Epoch [67/100], Train Loss: 0.013940, Val Loss: 0.014663, Test Loss: 0.020322
Epoch [68/100], Train Loss: 0.012664, Val Loss: 0.014858, Test Loss: 0.018648
Epoch [69/100], Train Loss: 0.012523, Val Loss: 0.014234, Test Loss: 0.018544
Epoch [70/100], Train Loss: 0.013514, Val Loss: 0.014670, Test Loss: 0.021837
Epoch [71/100], Train Loss: 0.012652, Val Loss: 0.015368, Test Loss: 0.020841
Epoch [72/100], Train Loss: 0.012055, Val Loss: 0.014430, Test Loss: 0.018366
Epoch [73/100], Train Loss: 0.013646, Val Loss: 0.016375, Test Loss: 0.018248
Epoch [74/100], Train Loss: 0.012101, Val Loss: 0.014171, Test Loss: 0.020864
Epoch [75/100], Train Loss: 0.011814, Val Loss: 0.014742, Test Loss: 0.021391
Epoch [76/100], Train Loss: 0.011088, Val Loss: 0.014960, Test Loss: 0.018687
Epoch [77/100], Train Loss: 0.012211, Val Loss: 0.015562, Test Loss: 0.022446
早停于第77轮
实际预测天数: 100
实际预测天数: 90
训练长期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=256, nhead=8, num_layers=5
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/150], Train Loss: 0.268721, Val Loss: 0.033619, Test Loss: 0.022304 *
Epoch [2/150], Train Loss: 0.097638, Val Loss: 0.046426, Test Loss: 0.034215
Epoch [3/150], Train Loss: 0.051148, Val Loss: 0.053133, Test Loss: 0.042585
Epoch [4/150], Train Loss: 0.050519, Val Loss: 0.042794, Test Loss: 0.032248
Epoch [5/150], Train Loss: 0.043057, Val Loss: 0.032735, Test Loss: 0.022281 *
Epoch [6/150], Train Loss: 0.037138, Val Loss: 0.036752, Test Loss: 0.027394
Epoch [7/150], Train Loss: 0.033296, Val Loss: 0.030561, Test Loss: 0.021164 *
Epoch [8/150], Train Loss: 0.032530, Val Loss: 0.034289, Test Loss: 0.025709
Epoch [9/150], Train Loss: 0.031885, Val Loss: 0.028452, Test Loss: 0.018580 *
Epoch [10/150], Train Loss: 0.029548, Val Loss: 0.027518, Test Loss: 0.018588 *
Epoch [11/150], Train Loss: 0.030115, Val Loss: 0.027357, Test Loss: 0.018311 *
Epoch [12/150], Train Loss: 0.031263, Val Loss: 0.027605, Test Loss: 0.019091
Epoch [13/150], Train Loss: 0.029129, Val Loss: 0.025757, Test Loss: 0.017189 *
Epoch [14/150], Train Loss: 0.036954, Val Loss: 0.026697, Test Loss: 0.018373
Epoch [15/150], Train Loss: 0.031819, Val Loss: 0.028734, Test Loss: 0.020617
Epoch [16/150], Train Loss: 0.029118, Val Loss: 0.027337, Test Loss: 0.018478
Epoch [17/150], Train Loss: 0.035944, Val Loss: 0.026156, Test Loss: 0.018046
Epoch [18/150], Train Loss: 0.029464, Val Loss: 0.033937, Test Loss: 0.028479
Epoch [19/150], Train Loss: 0.036296, Val Loss: 0.045359, Test Loss: 0.034678
Epoch [20/150], Train Loss: 0.029991, Val Loss: 0.031228, Test Loss: 0.022902
Epoch [21/150], Train Loss: 0.032871, Val Loss: 0.041372, Test Loss: 0.036289
Epoch [22/150], Train Loss: 0.032435, Val Loss: 0.049765, Test Loss: 0.040431
Epoch [23/150], Train Loss: 0.053044, Val Loss: 0.039833, Test Loss: 0.033461
Epoch [24/150], Train Loss: 0.024994, Val Loss: 0.050625, Test Loss: 0.047882
Epoch [25/150], Train Loss: 0.045656, Val Loss: 0.231833, Test Loss: 0.236490
Epoch [26/150], Train Loss: 0.164382, Val Loss: 0.024070, Test Loss: 0.017461 *
Epoch [27/150], Train Loss: 0.043624, Val Loss: 0.020895, Test Loss: 0.016978 *
Epoch [28/150], Train Loss: 0.030780, Val Loss: 0.031428, Test Loss: 0.028212
Epoch [29/150], Train Loss: 0.025877, Val Loss: 0.017311, Test Loss: 0.014606 *
Epoch [30/150], Train Loss: 0.027725, Val Loss: 0.017807, Test Loss: 0.016950
Epoch [31/150], Train Loss: 0.027306, Val Loss: 0.016158, Test Loss: 0.014922 *
Epoch [32/150], Train Loss: 0.025175, Val Loss: 0.021837, Test Loss: 0.021694
Epoch [33/150], Train Loss: 0.047155, Val Loss: 0.017606, Test Loss: 0.015845
Epoch [34/150], Train Loss: 0.019405, Val Loss: 0.016882, Test Loss: 0.016273
Epoch [35/150], Train Loss: 0.019619, Val Loss: 0.020492, Test Loss: 0.023533
Epoch [36/150], Train Loss: 0.026721, Val Loss: 0.017136, Test Loss: 0.016070
Epoch [37/150], Train Loss: 0.023523, Val Loss: 0.159956, Test Loss: 0.175734
Epoch [38/150], Train Loss: 0.113531, Val Loss: 0.058283, Test Loss: 0.053462
Epoch [39/150], Train Loss: 0.102128, Val Loss: 0.029018, Test Loss: 0.026822
Epoch [40/150], Train Loss: 0.028163, Val Loss: 0.041760, Test Loss: 0.048489
Epoch [41/150], Train Loss: 0.022491, Val Loss: 0.015927, Test Loss: 0.017651 *
Epoch [42/150], Train Loss: 0.020855, Val Loss: 0.023072, Test Loss: 0.023430
Epoch [43/150], Train Loss: 0.028187, Val Loss: 0.017656, Test Loss: 0.016330
Epoch [44/150], Train Loss: 0.019464, Val Loss: 0.014759, Test Loss: 0.014451 *
Epoch [45/150], Train Loss: 0.018467, Val Loss: 0.019845, Test Loss: 0.025049
Epoch [46/150], Train Loss: 0.023345, Val Loss: 0.024377, Test Loss: 0.020751
Epoch [47/150], Train Loss: 0.021041, Val Loss: 0.024480, Test Loss: 0.033552
Epoch [48/150], Train Loss: 0.022709, Val Loss: 0.024609, Test Loss: 0.034291
Epoch [49/150], Train Loss: 0.020307, Val Loss: 0.014885, Test Loss: 0.019262
Epoch [50/150], Train Loss: 0.016779, Val Loss: 0.019052, Test Loss: 0.029327
Epoch [51/150], Train Loss: 0.018802, Val Loss: 0.024615, Test Loss: 0.022666
Epoch [52/150], Train Loss: 0.016274, Val Loss: 0.016352, Test Loss: 0.025940
Epoch [53/150], Train Loss: 0.015397, Val Loss: 0.020647, Test Loss: 0.033937
Epoch [54/150], Train Loss: 0.016133, Val Loss: 0.041175, Test Loss: 0.054172
Epoch [55/150], Train Loss: 0.019433, Val Loss: 0.014117, Test Loss: 0.019322 *
Epoch [56/150], Train Loss: 0.015882, Val Loss: 0.014321, Test Loss: 0.018016
Epoch [57/150], Train Loss: 0.015115, Val Loss: 0.012695, Test Loss: 0.017657 *
Epoch [58/150], Train Loss: 0.014685, Val Loss: 0.013516, Test Loss: 0.016062
Epoch [59/150], Train Loss: 0.013355, Val Loss: 0.014855, Test Loss: 0.016912
Epoch [60/150], Train Loss: 0.014233, Val Loss: 0.014995, Test Loss: 0.018903
Epoch [61/150], Train Loss: 0.013785, Val Loss: 0.014749, Test Loss: 0.018531
Epoch [62/150], Train Loss: 0.011896, Val Loss: 0.014705, Test Loss: 0.017424
Epoch [63/150], Train Loss: 0.013641, Val Loss: 0.016231, Test Loss: 0.019410
Epoch [64/150], Train Loss: 0.013041, Val Loss: 0.015973, Test Loss: 0.023879
Epoch [65/150], Train Loss: 0.017383, Val Loss: 0.053361, Test Loss: 0.054778
Epoch [66/150], Train Loss: 0.033344, Val Loss: 0.022931, Test Loss: 0.025621
Epoch [67/150], Train Loss: 0.015723, Val Loss: 0.015432, Test Loss: 0.017082
Epoch [68/150], Train Loss: 0.015631, Val Loss: 0.021546, Test Loss: 0.024902
Epoch [69/150], Train Loss: 0.042771, Val Loss: 0.052483, Test Loss: 0.063279
Epoch [70/150], Train Loss: 0.018474, Val Loss: 0.017385, Test Loss: 0.021257
Epoch [71/150], Train Loss: 0.021094, Val Loss: 0.018499, Test Loss: 0.018684
Epoch [72/150], Train Loss: 0.020539, Val Loss: 0.017193, Test Loss: 0.022534
早停于第72轮
实际预测天数: 365
短期预测 - MSE: 155802.5861, MAE: 318.9654
长期预测 - MSE: 209257.7678, MAE: 358.3165

=== 实验 2/5 ===
训练短期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=128, nhead=8, num_layers=3
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/100], Train Loss: 0.062375, Val Loss: 0.028693, Test Loss: 0.021168 *
Epoch [2/100], Train Loss: 0.042383, Val Loss: 0.029227, Test Loss: 0.021662
Epoch [3/100], Train Loss: 0.035916, Val Loss: 0.027708, Test Loss: 0.020308 *
Epoch [4/100], Train Loss: 0.032471, Val Loss: 0.027412, Test Loss: 0.019571 *
Epoch [5/100], Train Loss: 0.034826, Val Loss: 0.027434, Test Loss: 0.019775
Epoch [6/100], Train Loss: 0.035979, Val Loss: 0.026599, Test Loss: 0.018609 *
Epoch [7/100], Train Loss: 0.034717, Val Loss: 0.025422, Test Loss: 0.018746 *
Epoch [8/100], Train Loss: 0.033420, Val Loss: 0.028070, Test Loss: 0.019954
Epoch [9/100], Train Loss: 0.038230, Val Loss: 0.038046, Test Loss: 0.029739
Epoch [10/100], Train Loss: 0.040949, Val Loss: 0.026900, Test Loss: 0.019842
Epoch [11/100], Train Loss: 0.041892, Val Loss: 0.024940, Test Loss: 0.018420 *
Epoch [12/100], Train Loss: 0.031305, Val Loss: 0.024151, Test Loss: 0.017420 *
Epoch [13/100], Train Loss: 0.041180, Val Loss: 0.032013, Test Loss: 0.028810
Epoch [14/100], Train Loss: 0.033363, Val Loss: 0.031386, Test Loss: 0.024155
Epoch [15/100], Train Loss: 0.032128, Val Loss: 0.024504, Test Loss: 0.020487
Epoch [16/100], Train Loss: 0.034044, Val Loss: 0.022830, Test Loss: 0.017719 *
Epoch [17/100], Train Loss: 0.036751, Val Loss: 0.022456, Test Loss: 0.017049 *
Epoch [18/100], Train Loss: 0.028724, Val Loss: 0.022736, Test Loss: 0.018447
Epoch [19/100], Train Loss: 0.028983, Val Loss: 0.044979, Test Loss: 0.039837
Epoch [20/100], Train Loss: 0.038988, Val Loss: 0.020325, Test Loss: 0.016659 *
Epoch [21/100], Train Loss: 0.027079, Val Loss: 0.042719, Test Loss: 0.040529
Epoch [22/100], Train Loss: 0.032984, Val Loss: 0.017358, Test Loss: 0.016160 *
Epoch [23/100], Train Loss: 0.046495, Val Loss: 0.023220, Test Loss: 0.020245
Epoch [24/100], Train Loss: 0.028203, Val Loss: 0.021729, Test Loss: 0.020923
Epoch [25/100], Train Loss: 0.023070, Val Loss: 0.015725, Test Loss: 0.016190 *
Epoch [26/100], Train Loss: 0.030692, Val Loss: 0.020506, Test Loss: 0.017930
Epoch [27/100], Train Loss: 0.026272, Val Loss: 0.021125, Test Loss: 0.020927
Epoch [28/100], Train Loss: 0.024772, Val Loss: 0.017235, Test Loss: 0.017603
Epoch [29/100], Train Loss: 0.028040, Val Loss: 0.025479, Test Loss: 0.024783
Epoch [30/100], Train Loss: 0.025117, Val Loss: 0.016010, Test Loss: 0.016842
Epoch [31/100], Train Loss: 0.023344, Val Loss: 0.013773, Test Loss: 0.016672 *
Epoch [32/100], Train Loss: 0.022439, Val Loss: 0.014702, Test Loss: 0.019766
Epoch [33/100], Train Loss: 0.021980, Val Loss: 0.013984, Test Loss: 0.016561
Epoch [34/100], Train Loss: 0.020393, Val Loss: 0.015199, Test Loss: 0.017828
Epoch [35/100], Train Loss: 0.021315, Val Loss: 0.012235, Test Loss: 0.015325 *
Epoch [36/100], Train Loss: 0.028003, Val Loss: 0.027273, Test Loss: 0.035170
Epoch [37/100], Train Loss: 0.024878, Val Loss: 0.015598, Test Loss: 0.019440
Epoch [38/100], Train Loss: 0.020339, Val Loss: 0.012531, Test Loss: 0.018316
Epoch [39/100], Train Loss: 0.019627, Val Loss: 0.014437, Test Loss: 0.021182
Epoch [40/100], Train Loss: 0.021718, Val Loss: 0.013681, Test Loss: 0.017513
Epoch [41/100], Train Loss: 0.020708, Val Loss: 0.014674, Test Loss: 0.017804
Epoch [42/100], Train Loss: 0.018242, Val Loss: 0.013591, Test Loss: 0.021282
Epoch [43/100], Train Loss: 0.021609, Val Loss: 0.018789, Test Loss: 0.020836
Epoch [44/100], Train Loss: 0.019825, Val Loss: 0.016398, Test Loss: 0.020684
Epoch [45/100], Train Loss: 0.019669, Val Loss: 0.012476, Test Loss: 0.019874
Epoch [46/100], Train Loss: 0.018008, Val Loss: 0.013009, Test Loss: 0.021739
Epoch [47/100], Train Loss: 0.019903, Val Loss: 0.014823, Test Loss: 0.020885
Epoch [48/100], Train Loss: 0.017572, Val Loss: 0.013728, Test Loss: 0.018550
Epoch [49/100], Train Loss: 0.016469, Val Loss: 0.012221, Test Loss: 0.018073 *
Epoch [50/100], Train Loss: 0.017178, Val Loss: 0.013128, Test Loss: 0.018475
Epoch [51/100], Train Loss: 0.017698, Val Loss: 0.014631, Test Loss: 0.020619
Epoch [52/100], Train Loss: 0.018326, Val Loss: 0.011586, Test Loss: 0.019848 *
Epoch [53/100], Train Loss: 0.016161, Val Loss: 0.012129, Test Loss: 0.018369
Epoch [54/100], Train Loss: 0.014192, Val Loss: 0.012535, Test Loss: 0.022098
Epoch [55/100], Train Loss: 0.014868, Val Loss: 0.011718, Test Loss: 0.022531
Epoch [56/100], Train Loss: 0.016287, Val Loss: 0.013833, Test Loss: 0.017329
Epoch [57/100], Train Loss: 0.014588, Val Loss: 0.013101, Test Loss: 0.019789
Epoch [58/100], Train Loss: 0.015439, Val Loss: 0.011702, Test Loss: 0.017488
Epoch [59/100], Train Loss: 0.014389, Val Loss: 0.014784, Test Loss: 0.018334
Epoch [60/100], Train Loss: 0.016080, Val Loss: 0.012856, Test Loss: 0.018711
Epoch [61/100], Train Loss: 0.014837, Val Loss: 0.012207, Test Loss: 0.017248
Epoch [62/100], Train Loss: 0.013719, Val Loss: 0.010980, Test Loss: 0.021555 *
Epoch [63/100], Train Loss: 0.013439, Val Loss: 0.012157, Test Loss: 0.021317
Epoch [64/100], Train Loss: 0.014337, Val Loss: 0.011206, Test Loss: 0.020575
Epoch [65/100], Train Loss: 0.013324, Val Loss: 0.012486, Test Loss: 0.018737
Epoch [66/100], Train Loss: 0.012933, Val Loss: 0.010855, Test Loss: 0.018117 *
Epoch [67/100], Train Loss: 0.012996, Val Loss: 0.010553, Test Loss: 0.019058 *
Epoch [68/100], Train Loss: 0.013141, Val Loss: 0.011145, Test Loss: 0.018499
Epoch [69/100], Train Loss: 0.012007, Val Loss: 0.011398, Test Loss: 0.019820
Epoch [70/100], Train Loss: 0.012996, Val Loss: 0.011957, Test Loss: 0.018505
Epoch [71/100], Train Loss: 0.011525, Val Loss: 0.011802, Test Loss: 0.020132
Epoch [72/100], Train Loss: 0.012736, Val Loss: 0.011097, Test Loss: 0.018393
Epoch [73/100], Train Loss: 0.012828, Val Loss: 0.010848, Test Loss: 0.019938
Epoch [74/100], Train Loss: 0.011160, Val Loss: 0.011169, Test Loss: 0.019188
Epoch [75/100], Train Loss: 0.011730, Val Loss: 0.011701, Test Loss: 0.017449
Epoch [76/100], Train Loss: 0.011657, Val Loss: 0.011159, Test Loss: 0.023681
Epoch [77/100], Train Loss: 0.013159, Val Loss: 0.011055, Test Loss: 0.017578
Epoch [78/100], Train Loss: 0.012902, Val Loss: 0.012290, Test Loss: 0.017800
Epoch [79/100], Train Loss: 0.012476, Val Loss: 0.011001, Test Loss: 0.020234
Epoch [80/100], Train Loss: 0.011031, Val Loss: 0.012384, Test Loss: 0.017271
Epoch [81/100], Train Loss: 0.010422, Val Loss: 0.010951, Test Loss: 0.018675
Epoch [82/100], Train Loss: 0.012361, Val Loss: 0.011642, Test Loss: 0.018184
早停于第82轮
实际预测天数: 100
实际预测天数: 90
训练长期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=256, nhead=8, num_layers=5
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/150], Train Loss: 0.088384, Val Loss: 0.042893, Test Loss: 0.032946 *
Epoch [2/150], Train Loss: 0.051570, Val Loss: 0.020985, Test Loss: 0.021626 *
Epoch [3/150], Train Loss: 0.043739, Val Loss: 0.029199, Test Loss: 0.031984
Epoch [4/150], Train Loss: 0.039172, Val Loss: 0.020375, Test Loss: 0.019184 *
Epoch [5/150], Train Loss: 0.031088, Val Loss: 0.019404, Test Loss: 0.018312 *
Epoch [6/150], Train Loss: 0.037799, Val Loss: 0.020364, Test Loss: 0.021229
Epoch [7/150], Train Loss: 0.033050, Val Loss: 0.018823, Test Loss: 0.018126 *
Epoch [8/150], Train Loss: 0.035274, Val Loss: 0.039368, Test Loss: 0.035378
Epoch [9/150], Train Loss: 0.037033, Val Loss: 0.031152, Test Loss: 0.028363
Epoch [10/150], Train Loss: 0.034367, Val Loss: 0.021218, Test Loss: 0.019622
Epoch [11/150], Train Loss: 0.033657, Val Loss: 0.026247, Test Loss: 0.029589
Epoch [12/150], Train Loss: 0.064718, Val Loss: 0.136547, Test Loss: 0.123423
Epoch [13/150], Train Loss: 0.054984, Val Loss: 0.023498, Test Loss: 0.022216
Epoch [14/150], Train Loss: 0.056159, Val Loss: 0.024800, Test Loss: 0.027183
Epoch [15/150], Train Loss: 0.051688, Val Loss: 0.021660, Test Loss: 0.022090
Epoch [16/150], Train Loss: 0.052902, Val Loss: 0.017324, Test Loss: 0.018001 *
Epoch [17/150], Train Loss: 0.034338, Val Loss: 0.035911, Test Loss: 0.030508
Epoch [18/150], Train Loss: 0.037810, Val Loss: 0.062122, Test Loss: 0.058038
Epoch [19/150], Train Loss: 0.049740, Val Loss: 0.033039, Test Loss: 0.033625
Epoch [20/150], Train Loss: 0.035275, Val Loss: 0.029636, Test Loss: 0.026510
Epoch [21/150], Train Loss: 0.056495, Val Loss: 0.029071, Test Loss: 0.032899
Epoch [22/150], Train Loss: 0.047081, Val Loss: 0.062694, Test Loss: 0.068695
Epoch [23/150], Train Loss: 0.055657, Val Loss: 0.019392, Test Loss: 0.021983
Epoch [24/150], Train Loss: 0.036649, Val Loss: 0.017218, Test Loss: 0.018554 *
Epoch [25/150], Train Loss: 0.031540, Val Loss: 0.020840, Test Loss: 0.023661
Epoch [26/150], Train Loss: 0.044776, Val Loss: 0.027685, Test Loss: 0.031047
Epoch [27/150], Train Loss: 0.032689, Val Loss: 0.011438, Test Loss: 0.015845 *
Epoch [28/150], Train Loss: 0.025746, Val Loss: 0.012595, Test Loss: 0.016072
Epoch [29/150], Train Loss: 0.033665, Val Loss: 0.014838, Test Loss: 0.018592
Epoch [30/150], Train Loss: 0.038817, Val Loss: 0.014077, Test Loss: 0.018507
Epoch [31/150], Train Loss: 0.028655, Val Loss: 0.013297, Test Loss: 0.016960
Epoch [32/150], Train Loss: 0.027532, Val Loss: 0.009984, Test Loss: 0.015375 *
Epoch [33/150], Train Loss: 0.030909, Val Loss: 0.012803, Test Loss: 0.016619
Epoch [34/150], Train Loss: 0.023030, Val Loss: 0.015450, Test Loss: 0.019028
Epoch [35/150], Train Loss: 0.029714, Val Loss: 0.015843, Test Loss: 0.020642
Epoch [36/150], Train Loss: 0.025394, Val Loss: 0.026736, Test Loss: 0.030378
Epoch [37/150], Train Loss: 0.028779, Val Loss: 0.011991, Test Loss: 0.016581
Epoch [38/150], Train Loss: 0.028172, Val Loss: 0.013463, Test Loss: 0.023127
Epoch [39/150], Train Loss: 0.068133, Val Loss: 0.020879, Test Loss: 0.034172
Epoch [40/150], Train Loss: 0.050830, Val Loss: 0.023903, Test Loss: 0.031951
Epoch [41/150], Train Loss: 0.029080, Val Loss: 0.011800, Test Loss: 0.016296
Epoch [42/150], Train Loss: 0.024034, Val Loss: 0.010064, Test Loss: 0.017744
Epoch [43/150], Train Loss: 0.029481, Val Loss: 0.016485, Test Loss: 0.020335
Epoch [44/150], Train Loss: 0.018783, Val Loss: 0.024581, Test Loss: 0.042400
Epoch [45/150], Train Loss: 0.029152, Val Loss: 0.017011, Test Loss: 0.032357
Epoch [46/150], Train Loss: 0.020662, Val Loss: 0.009880, Test Loss: 0.017757 *
Epoch [47/150], Train Loss: 0.017555, Val Loss: 0.009287, Test Loss: 0.015928 *
Epoch [48/150], Train Loss: 0.018468, Val Loss: 0.011714, Test Loss: 0.018277
Epoch [49/150], Train Loss: 0.018465, Val Loss: 0.010085, Test Loss: 0.016292
Epoch [50/150], Train Loss: 0.018453, Val Loss: 0.009912, Test Loss: 0.016596
Epoch [51/150], Train Loss: 0.017884, Val Loss: 0.011551, Test Loss: 0.016744
Epoch [52/150], Train Loss: 0.020397, Val Loss: 0.014900, Test Loss: 0.026339
Epoch [53/150], Train Loss: 0.018725, Val Loss: 0.011913, Test Loss: 0.023975
Epoch [54/150], Train Loss: 0.019953, Val Loss: 0.021616, Test Loss: 0.042483
Epoch [55/150], Train Loss: 0.087756, Val Loss: 0.011568, Test Loss: 0.017288
Epoch [56/150], Train Loss: 0.021900, Val Loss: 0.013530, Test Loss: 0.025788
Epoch [57/150], Train Loss: 0.026803, Val Loss: 0.017467, Test Loss: 0.022361
Epoch [58/150], Train Loss: 0.028485, Val Loss: 0.022087, Test Loss: 0.024810
Epoch [59/150], Train Loss: 0.022949, Val Loss: 0.010422, Test Loss: 0.021554
Epoch [60/150], Train Loss: 0.017681, Val Loss: 0.022258, Test Loss: 0.023357
Epoch [61/150], Train Loss: 0.017108, Val Loss: 0.009579, Test Loss: 0.022666
Epoch [62/150], Train Loss: 0.018481, Val Loss: 0.008273, Test Loss: 0.016621 *
Epoch [63/150], Train Loss: 0.015832, Val Loss: 0.008093, Test Loss: 0.017348 *
Epoch [64/150], Train Loss: 0.029599, Val Loss: 0.010837, Test Loss: 0.016268
Epoch [65/150], Train Loss: 0.014978, Val Loss: 0.008558, Test Loss: 0.018011
Epoch [66/150], Train Loss: 0.013287, Val Loss: 0.010278, Test Loss: 0.022926
Epoch [67/150], Train Loss: 0.013292, Val Loss: 0.008744, Test Loss: 0.019433
Epoch [68/150], Train Loss: 0.014617, Val Loss: 0.009452, Test Loss: 0.016505
Epoch [69/150], Train Loss: 0.014442, Val Loss: 0.010879, Test Loss: 0.018999
Epoch [70/150], Train Loss: 0.019758, Val Loss: 0.007642, Test Loss: 0.017805 *
Epoch [71/150], Train Loss: 0.013964, Val Loss: 0.010470, Test Loss: 0.015939
Epoch [72/150], Train Loss: 0.013144, Val Loss: 0.010184, Test Loss: 0.022231
Epoch [73/150], Train Loss: 0.013108, Val Loss: 0.010969, Test Loss: 0.023409
Epoch [74/150], Train Loss: 0.015123, Val Loss: 0.011347, Test Loss: 0.016663
Epoch [75/150], Train Loss: 0.015436, Val Loss: 0.011371, Test Loss: 0.028952
Epoch [76/150], Train Loss: 0.014829, Val Loss: 0.009511, Test Loss: 0.016454
Epoch [77/150], Train Loss: 0.011565, Val Loss: 0.009844, Test Loss: 0.016614
Epoch [78/150], Train Loss: 0.010973, Val Loss: 0.011297, Test Loss: 0.020038
Epoch [79/150], Train Loss: 0.011362, Val Loss: 0.008347, Test Loss: 0.022221
Epoch [80/150], Train Loss: 0.011751, Val Loss: 0.010714, Test Loss: 0.021367
Epoch [81/150], Train Loss: 0.013556, Val Loss: 0.008049, Test Loss: 0.019046
Epoch [82/150], Train Loss: 0.011612, Val Loss: 0.015366, Test Loss: 0.036940
Epoch [83/150], Train Loss: 0.010858, Val Loss: 0.009497, Test Loss: 0.018845
Epoch [84/150], Train Loss: 0.009973, Val Loss: 0.009303, Test Loss: 0.023108
Epoch [85/150], Train Loss: 0.013452, Val Loss: 0.008751, Test Loss: 0.018952
早停于第85轮
实际预测天数: 365
短期预测 - MSE: 176627.1185, MAE: 346.6543
长期预测 - MSE: 180050.7444, MAE: 331.7889

=== 实验 3/5 ===
训练短期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=128, nhead=8, num_layers=3
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/100], Train Loss: 0.192614, Val Loss: 0.032098, Test Loss: 0.033190 *
Epoch [2/100], Train Loss: 0.052114, Val Loss: 0.034855, Test Loss: 0.024190
Epoch [3/100], Train Loss: 0.043597, Val Loss: 0.032600, Test Loss: 0.024536
Epoch [4/100], Train Loss: 0.039443, Val Loss: 0.029531, Test Loss: 0.028912 *
Epoch [5/100], Train Loss: 0.037459, Val Loss: 0.028055, Test Loss: 0.027855 *
Epoch [6/100], Train Loss: 0.040432, Val Loss: 0.028614, Test Loss: 0.032722
Epoch [7/100], Train Loss: 0.036464, Val Loss: 0.029655, Test Loss: 0.021742
Epoch [8/100], Train Loss: 0.033446, Val Loss: 0.035827, Test Loss: 0.021339
Epoch [9/100], Train Loss: 0.031101, Val Loss: 0.026011, Test Loss: 0.019444 *
Epoch [10/100], Train Loss: 0.032079, Val Loss: 0.038982, Test Loss: 0.025164
Epoch [11/100], Train Loss: 0.031362, Val Loss: 0.043893, Test Loss: 0.027888
Epoch [12/100], Train Loss: 0.032237, Val Loss: 0.023432, Test Loss: 0.018639 *
Epoch [13/100], Train Loss: 0.030586, Val Loss: 0.027262, Test Loss: 0.019587
Epoch [14/100], Train Loss: 0.029270, Val Loss: 0.029691, Test Loss: 0.035158
Epoch [15/100], Train Loss: 0.037030, Val Loss: 0.030711, Test Loss: 0.039371
Epoch [16/100], Train Loss: 0.048399, Val Loss: 0.038486, Test Loss: 0.024601
Epoch [17/100], Train Loss: 0.030642, Val Loss: 0.026499, Test Loss: 0.019110
Epoch [18/100], Train Loss: 0.036929, Val Loss: 0.029087, Test Loss: 0.019031
Epoch [19/100], Train Loss: 0.027653, Val Loss: 0.020795, Test Loss: 0.020319 *
Epoch [20/100], Train Loss: 0.030449, Val Loss: 0.023323, Test Loss: 0.018198
Epoch [21/100], Train Loss: 0.032023, Val Loss: 0.025443, Test Loss: 0.018556
Epoch [22/100], Train Loss: 0.029643, Val Loss: 0.027576, Test Loss: 0.018193
Epoch [23/100], Train Loss: 0.028504, Val Loss: 0.027044, Test Loss: 0.019172
Epoch [24/100], Train Loss: 0.024211, Val Loss: 0.018339, Test Loss: 0.025701 *
Epoch [25/100], Train Loss: 0.026254, Val Loss: 0.018448, Test Loss: 0.015708
Epoch [26/100], Train Loss: 0.031456, Val Loss: 0.016587, Test Loss: 0.015896 *
Epoch [27/100], Train Loss: 0.023901, Val Loss: 0.015598, Test Loss: 0.015033 *
Epoch [28/100], Train Loss: 0.024125, Val Loss: 0.025322, Test Loss: 0.019838
Epoch [29/100], Train Loss: 0.025413, Val Loss: 0.016470, Test Loss: 0.024577
Epoch [30/100], Train Loss: 0.024418, Val Loss: 0.026252, Test Loss: 0.019262
Epoch [31/100], Train Loss: 0.025196, Val Loss: 0.017148, Test Loss: 0.015665
Epoch [32/100], Train Loss: 0.022514, Val Loss: 0.015949, Test Loss: 0.015932
Epoch [33/100], Train Loss: 0.021821, Val Loss: 0.018077, Test Loss: 0.015330
Epoch [34/100], Train Loss: 0.020844, Val Loss: 0.018781, Test Loss: 0.015737
Epoch [35/100], Train Loss: 0.021897, Val Loss: 0.015151, Test Loss: 0.016614 *
Epoch [36/100], Train Loss: 0.019842, Val Loss: 0.021533, Test Loss: 0.017130
Epoch [37/100], Train Loss: 0.019381, Val Loss: 0.018797, Test Loss: 0.016895
Epoch [38/100], Train Loss: 0.022088, Val Loss: 0.019991, Test Loss: 0.015999
Epoch [39/100], Train Loss: 0.020896, Val Loss: 0.023315, Test Loss: 0.019504
Epoch [40/100], Train Loss: 0.021543, Val Loss: 0.016099, Test Loss: 0.019779
Epoch [41/100], Train Loss: 0.019826, Val Loss: 0.016860, Test Loss: 0.016763
Epoch [42/100], Train Loss: 0.016582, Val Loss: 0.022366, Test Loss: 0.016525
Epoch [43/100], Train Loss: 0.018487, Val Loss: 0.015209, Test Loss: 0.016092
Epoch [44/100], Train Loss: 0.019175, Val Loss: 0.021474, Test Loss: 0.016285
Epoch [45/100], Train Loss: 0.016752, Val Loss: 0.015875, Test Loss: 0.016008
Epoch [46/100], Train Loss: 0.017389, Val Loss: 0.017815, Test Loss: 0.017006
Epoch [47/100], Train Loss: 0.017569, Val Loss: 0.017176, Test Loss: 0.016438
Epoch [48/100], Train Loss: 0.016058, Val Loss: 0.020783, Test Loss: 0.017830
Epoch [49/100], Train Loss: 0.016355, Val Loss: 0.018303, Test Loss: 0.016369
Epoch [50/100], Train Loss: 0.016033, Val Loss: 0.015450, Test Loss: 0.018185
早停于第50轮
实际预测天数: 100
实际预测天数: 90
训练长期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=256, nhead=8, num_layers=5
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/150], Train Loss: 0.249844, Val Loss: 0.094999, Test Loss: 0.101087 *
Epoch [2/150], Train Loss: 0.091163, Val Loss: 0.049175, Test Loss: 0.047008 *
Epoch [3/150], Train Loss: 0.052916, Val Loss: 0.032325, Test Loss: 0.023500 *
Epoch [4/150], Train Loss: 0.041448, Val Loss: 0.036821, Test Loss: 0.026073
Epoch [5/150], Train Loss: 0.039084, Val Loss: 0.043884, Test Loss: 0.039622
Epoch [6/150], Train Loss: 0.040255, Val Loss: 0.030078, Test Loss: 0.023739 *
Epoch [7/150], Train Loss: 0.044841, Val Loss: 0.026509, Test Loss: 0.021642 *
Epoch [8/150], Train Loss: 0.046877, Val Loss: 0.034990, Test Loss: 0.027784
Epoch [9/150], Train Loss: 0.037289, Val Loss: 0.026422, Test Loss: 0.021299 *
Epoch [10/150], Train Loss: 0.035923, Val Loss: 0.026232, Test Loss: 0.021856 *
Epoch [11/150], Train Loss: 0.046771, Val Loss: 0.110612, Test Loss: 0.101136
Epoch [12/150], Train Loss: 0.068082, Val Loss: 0.028451, Test Loss: 0.025364
Epoch [13/150], Train Loss: 0.044268, Val Loss: 0.035051, Test Loss: 0.027074
Epoch [14/150], Train Loss: 0.034342, Val Loss: 0.033663, Test Loss: 0.030200
Epoch [15/150], Train Loss: 0.033858, Val Loss: 0.026473, Test Loss: 0.022178
Epoch [16/150], Train Loss: 0.062946, Val Loss: 0.026691, Test Loss: 0.020540
Epoch [17/150], Train Loss: 0.043554, Val Loss: 0.021276, Test Loss: 0.018105 *
Epoch [18/150], Train Loss: 0.041746, Val Loss: 0.023322, Test Loss: 0.020040
Epoch [19/150], Train Loss: 0.086268, Val Loss: 0.104787, Test Loss: 0.088872
Epoch [20/150], Train Loss: 0.100642, Val Loss: 0.194762, Test Loss: 0.191499
Epoch [21/150], Train Loss: 0.107764, Val Loss: 0.028364, Test Loss: 0.025248
Epoch [22/150], Train Loss: 0.052468, Val Loss: 0.224019, Test Loss: 0.227986
Epoch [23/150], Train Loss: 0.097335, Val Loss: 0.048431, Test Loss: 0.035553
Epoch [24/150], Train Loss: 0.063192, Val Loss: 0.034007, Test Loss: 0.024739
Epoch [25/150], Train Loss: 0.042209, Val Loss: 0.025843, Test Loss: 0.020776
Epoch [26/150], Train Loss: 0.041283, Val Loss: 0.025897, Test Loss: 0.022273
Epoch [27/150], Train Loss: 0.035772, Val Loss: 0.067424, Test Loss: 0.061912
Epoch [28/150], Train Loss: 0.059693, Val Loss: 0.020594, Test Loss: 0.019137 *
Epoch [29/150], Train Loss: 0.035296, Val Loss: 0.016916, Test Loss: 0.017554 *
Epoch [30/150], Train Loss: 0.038476, Val Loss: 0.019664, Test Loss: 0.021238
Epoch [31/150], Train Loss: 0.032577, Val Loss: 0.014409, Test Loss: 0.016150 *
Epoch [32/150], Train Loss: 0.031258, Val Loss: 0.019283, Test Loss: 0.017948
Epoch [33/150], Train Loss: 0.028103, Val Loss: 0.014956, Test Loss: 0.016685
Epoch [34/150], Train Loss: 0.029890, Val Loss: 0.013047, Test Loss: 0.016545 *
Epoch [35/150], Train Loss: 0.026664, Val Loss: 0.013118, Test Loss: 0.016450
Epoch [36/150], Train Loss: 0.027186, Val Loss: 0.013200, Test Loss: 0.017071
Epoch [37/150], Train Loss: 0.026789, Val Loss: 0.024756, Test Loss: 0.035811
Epoch [38/150], Train Loss: 0.034281, Val Loss: 0.042091, Test Loss: 0.043416
Epoch [39/150], Train Loss: 0.037908, Val Loss: 0.012710, Test Loss: 0.016212 *
Epoch [40/150], Train Loss: 0.023888, Val Loss: 0.013761, Test Loss: 0.017132
Epoch [41/150], Train Loss: 0.030947, Val Loss: 0.012217, Test Loss: 0.015636 *
Epoch [42/150], Train Loss: 0.026830, Val Loss: 0.015814, Test Loss: 0.019112
Epoch [43/150], Train Loss: 0.025226, Val Loss: 0.029256, Test Loss: 0.037180
Epoch [44/150], Train Loss: 0.027871, Val Loss: 0.011070, Test Loss: 0.016385 *
Epoch [45/150], Train Loss: 0.025867, Val Loss: 0.016856, Test Loss: 0.020984
Epoch [46/150], Train Loss: 0.023038, Val Loss: 0.019561, Test Loss: 0.022364
Epoch [47/150], Train Loss: 0.022512, Val Loss: 0.018441, Test Loss: 0.022244
Epoch [48/150], Train Loss: 0.028459, Val Loss: 0.013238, Test Loss: 0.024486
Epoch [49/150], Train Loss: 0.057401, Val Loss: 0.015719, Test Loss: 0.026154
Epoch [50/150], Train Loss: 0.022999, Val Loss: 0.033090, Test Loss: 0.057491
Epoch [51/150], Train Loss: 0.042816, Val Loss: 0.010673, Test Loss: 0.019368 *
Epoch [52/150], Train Loss: 0.022764, Val Loss: 0.016854, Test Loss: 0.020799
Epoch [53/150], Train Loss: 0.021788, Val Loss: 0.009955, Test Loss: 0.018941 *
Epoch [54/150], Train Loss: 0.019837, Val Loss: 0.013860, Test Loss: 0.029174
Epoch [55/150], Train Loss: 0.019337, Val Loss: 0.011208, Test Loss: 0.017285
Epoch [56/150], Train Loss: 0.016364, Val Loss: 0.022586, Test Loss: 0.037010
Epoch [57/150], Train Loss: 0.024779, Val Loss: 0.021095, Test Loss: 0.041320
Epoch [58/150], Train Loss: 0.021203, Val Loss: 0.010474, Test Loss: 0.017286
Epoch [59/150], Train Loss: 0.016017, Val Loss: 0.012874, Test Loss: 0.019045
Epoch [60/150], Train Loss: 0.020305, Val Loss: 0.012419, Test Loss: 0.017776
Epoch [61/150], Train Loss: 0.019846, Val Loss: 0.010149, Test Loss: 0.017189
Epoch [62/150], Train Loss: 0.020117, Val Loss: 0.014290, Test Loss: 0.032227
Epoch [63/150], Train Loss: 0.017838, Val Loss: 0.011011, Test Loss: 0.023376
Epoch [64/150], Train Loss: 0.024232, Val Loss: 0.014399, Test Loss: 0.018386
Epoch [65/150], Train Loss: 0.019180, Val Loss: 0.011629, Test Loss: 0.017549
Epoch [66/150], Train Loss: 0.017625, Val Loss: 0.208870, Test Loss: 0.297843
Epoch [67/150], Train Loss: 0.047221, Val Loss: 0.010697, Test Loss: 0.018222
Epoch [68/150], Train Loss: 0.031319, Val Loss: 0.010671, Test Loss: 0.016179
早停于第68轮
实际预测天数: 365
短期预测 - MSE: 163075.8517, MAE: 334.8514
长期预测 - MSE: 183923.7662, MAE: 328.1840

=== 实验 4/5 ===
训练短期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=128, nhead=8, num_layers=3
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/100], Train Loss: 0.095117, Val Loss: 0.021355, Test Loss: 0.020609 *
Epoch [2/100], Train Loss: 0.044267, Val Loss: 0.021710, Test Loss: 0.020456
Epoch [3/100], Train Loss: 0.035354, Val Loss: 0.028542, Test Loss: 0.024244
Epoch [4/100], Train Loss: 0.038098, Val Loss: 0.026782, Test Loss: 0.023037
Epoch [5/100], Train Loss: 0.034562, Val Loss: 0.021637, Test Loss: 0.018937
Epoch [6/100], Train Loss: 0.034209, Val Loss: 0.027479, Test Loss: 0.021499
Epoch [7/100], Train Loss: 0.035326, Val Loss: 0.029092, Test Loss: 0.022878
Epoch [8/100], Train Loss: 0.032723, Val Loss: 0.020893, Test Loss: 0.018445 *
Epoch [9/100], Train Loss: 0.041262, Val Loss: 0.047308, Test Loss: 0.039356
Epoch [10/100], Train Loss: 0.045698, Val Loss: 0.019710, Test Loss: 0.018425 *
Epoch [11/100], Train Loss: 0.044537, Val Loss: 0.021404, Test Loss: 0.017600
Epoch [12/100], Train Loss: 0.037486, Val Loss: 0.024398, Test Loss: 0.031146
Epoch [13/100], Train Loss: 0.039698, Val Loss: 0.019194, Test Loss: 0.017697 *
Epoch [14/100], Train Loss: 0.038444, Val Loss: 0.046007, Test Loss: 0.058959
Epoch [15/100], Train Loss: 0.070670, Val Loss: 0.046077, Test Loss: 0.037193
Epoch [16/100], Train Loss: 0.048589, Val Loss: 0.056227, Test Loss: 0.044159
Epoch [17/100], Train Loss: 0.039690, Val Loss: 0.044856, Test Loss: 0.058999
Epoch [18/100], Train Loss: 0.037355, Val Loss: 0.022476, Test Loss: 0.017934
Epoch [19/100], Train Loss: 0.034324, Val Loss: 0.037146, Test Loss: 0.027411
Epoch [20/100], Train Loss: 0.031553, Val Loss: 0.016987, Test Loss: 0.018619 *
Epoch [21/100], Train Loss: 0.040324, Val Loss: 0.019011, Test Loss: 0.016684
Epoch [22/100], Train Loss: 0.030995, Val Loss: 0.035358, Test Loss: 0.048464
Epoch [23/100], Train Loss: 0.050353, Val Loss: 0.044703, Test Loss: 0.035206
Epoch [24/100], Train Loss: 0.041177, Val Loss: 0.019869, Test Loss: 0.026716
Epoch [25/100], Train Loss: 0.054007, Val Loss: 0.019260, Test Loss: 0.015206
Epoch [26/100], Train Loss: 0.032287, Val Loss: 0.022487, Test Loss: 0.028911
Epoch [27/100], Train Loss: 0.040122, Val Loss: 0.016086, Test Loss: 0.015133 *
Epoch [28/100], Train Loss: 0.045791, Val Loss: 0.018095, Test Loss: 0.014355
Epoch [29/100], Train Loss: 0.030171, Val Loss: 0.037443, Test Loss: 0.027368
Epoch [30/100], Train Loss: 0.036408, Val Loss: 0.025153, Test Loss: 0.018471
Epoch [31/100], Train Loss: 0.029019, Val Loss: 0.020816, Test Loss: 0.015403
Epoch [32/100], Train Loss: 0.025817, Val Loss: 0.016328, Test Loss: 0.015476
Epoch [33/100], Train Loss: 0.028926, Val Loss: 0.026321, Test Loss: 0.019053
Epoch [34/100], Train Loss: 0.029365, Val Loss: 0.022155, Test Loss: 0.015998
Epoch [35/100], Train Loss: 0.026120, Val Loss: 0.017970, Test Loss: 0.014551
Epoch [36/100], Train Loss: 0.025147, Val Loss: 0.016743, Test Loss: 0.015749
Epoch [37/100], Train Loss: 0.022802, Val Loss: 0.019781, Test Loss: 0.015362
Epoch [38/100], Train Loss: 0.026039, Val Loss: 0.036271, Test Loss: 0.025698
Epoch [39/100], Train Loss: 0.027417, Val Loss: 0.020872, Test Loss: 0.015177
Epoch [40/100], Train Loss: 0.022277, Val Loss: 0.016216, Test Loss: 0.016633
Epoch [41/100], Train Loss: 0.022891, Val Loss: 0.022703, Test Loss: 0.016364
Epoch [42/100], Train Loss: 0.022323, Val Loss: 0.016331, Test Loss: 0.015457
早停于第42轮
实际预测天数: 100
实际预测天数: 90
训练长期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=256, nhead=8, num_layers=5
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/150], Train Loss: 0.506489, Val Loss: 0.213202, Test Loss: 0.177134 *
Epoch [2/150], Train Loss: 0.120093, Val Loss: 0.058242, Test Loss: 0.031685 *
Epoch [3/150], Train Loss: 0.055426, Val Loss: 0.041482, Test Loss: 0.022159 *
Epoch [4/150], Train Loss: 0.037708, Val Loss: 0.039468, Test Loss: 0.021891 *
Epoch [5/150], Train Loss: 0.037733, Val Loss: 0.031437, Test Loss: 0.017874 *
Epoch [6/150], Train Loss: 0.043258, Val Loss: 0.035710, Test Loss: 0.023820
Epoch [7/150], Train Loss: 0.036484, Val Loss: 0.061424, Test Loss: 0.041004
Epoch [8/150], Train Loss: 0.040698, Val Loss: 0.059941, Test Loss: 0.038415
Epoch [9/150], Train Loss: 0.043686, Val Loss: 0.035240, Test Loss: 0.020867
Epoch [10/150], Train Loss: 0.047639, Val Loss: 0.029680, Test Loss: 0.020933 *
Epoch [11/150], Train Loss: 0.038519, Val Loss: 0.029592, Test Loss: 0.020321 *
Epoch [12/150], Train Loss: 0.030813, Val Loss: 0.029345, Test Loss: 0.018804 *
Epoch [13/150], Train Loss: 0.032120, Val Loss: 0.031730, Test Loss: 0.027337
Epoch [14/150], Train Loss: 0.040533, Val Loss: 0.031510, Test Loss: 0.023624
Epoch [15/150], Train Loss: 0.036852, Val Loss: 0.028009, Test Loss: 0.017983 *
Epoch [16/150], Train Loss: 0.041206, Val Loss: 0.081630, Test Loss: 0.066490
Epoch [17/150], Train Loss: 0.059724, Val Loss: 0.038471, Test Loss: 0.025429
Epoch [18/150], Train Loss: 0.035609, Val Loss: 0.044779, Test Loss: 0.028987
Epoch [19/150], Train Loss: 0.033710, Val Loss: 0.028657, Test Loss: 0.018409
Epoch [20/150], Train Loss: 0.029563, Val Loss: 0.026428, Test Loss: 0.018050 *
Epoch [21/150], Train Loss: 0.029533, Val Loss: 0.029450, Test Loss: 0.022938
Epoch [22/150], Train Loss: 0.029460, Val Loss: 0.036645, Test Loss: 0.035496
Epoch [23/150], Train Loss: 0.056447, Val Loss: 0.034170, Test Loss: 0.030566
Epoch [24/150], Train Loss: 0.034330, Val Loss: 0.027677, Test Loss: 0.019112
Epoch [25/150], Train Loss: 0.031041, Val Loss: 0.033588, Test Loss: 0.025460
Epoch [26/150], Train Loss: 0.041545, Val Loss: 0.020384, Test Loss: 0.016364 *
Epoch [27/150], Train Loss: 0.034315, Val Loss: 0.024590, Test Loss: 0.017290
Epoch [28/150], Train Loss: 0.025551, Val Loss: 0.029800, Test Loss: 0.038727
Epoch [29/150], Train Loss: 0.034496, Val Loss: 0.036061, Test Loss: 0.031044
Epoch [30/150], Train Loss: 0.030027, Val Loss: 0.018578, Test Loss: 0.023122 *
Epoch [31/150], Train Loss: 0.022912, Val Loss: 0.010603, Test Loss: 0.014408 *
Epoch [32/150], Train Loss: 0.033309, Val Loss: 0.015454, Test Loss: 0.018313
Epoch [33/150], Train Loss: 0.024119, Val Loss: 0.010110, Test Loss: 0.015566 *
Epoch [34/150], Train Loss: 0.018807, Val Loss: 0.010970, Test Loss: 0.014207
Epoch [35/150], Train Loss: 0.021859, Val Loss: 0.008817, Test Loss: 0.016096 *
Epoch [36/150], Train Loss: 0.024141, Val Loss: 0.016183, Test Loss: 0.015626
Epoch [37/150], Train Loss: 0.034394, Val Loss: 0.022665, Test Loss: 0.021641
Epoch [38/150], Train Loss: 0.033949, Val Loss: 0.045700, Test Loss: 0.044701
Epoch [39/150], Train Loss: 0.063244, Val Loss: 0.020997, Test Loss: 0.020243
Epoch [40/150], Train Loss: 0.028151, Val Loss: 0.012003, Test Loss: 0.019564
Epoch [41/150], Train Loss: 0.025555, Val Loss: 0.011598, Test Loss: 0.015598
Epoch [42/150], Train Loss: 0.031060, Val Loss: 0.010708, Test Loss: 0.016166
Epoch [43/150], Train Loss: 0.019218, Val Loss: 0.009235, Test Loss: 0.015077
Epoch [44/150], Train Loss: 0.021681, Val Loss: 0.010213, Test Loss: 0.022370
Epoch [45/150], Train Loss: 0.023965, Val Loss: 0.011592, Test Loss: 0.014627
Epoch [46/150], Train Loss: 0.023934, Val Loss: 0.023092, Test Loss: 0.024409
Epoch [47/150], Train Loss: 0.022093, Val Loss: 0.008810, Test Loss: 0.016242 *
Epoch [48/150], Train Loss: 0.019968, Val Loss: 0.009590, Test Loss: 0.020432
Epoch [49/150], Train Loss: 0.019612, Val Loss: 0.010579, Test Loss: 0.015033
Epoch [50/150], Train Loss: 0.016572, Val Loss: 0.013317, Test Loss: 0.027825
Epoch [51/150], Train Loss: 0.016554, Val Loss: 0.009290, Test Loss: 0.019526
Epoch [52/150], Train Loss: 0.018117, Val Loss: 0.010844, Test Loss: 0.022759
Epoch [53/150], Train Loss: 0.017173, Val Loss: 0.009012, Test Loss: 0.018847
Epoch [54/150], Train Loss: 0.016247, Val Loss: 0.008152, Test Loss: 0.018458 *
Epoch [55/150], Train Loss: 0.016775, Val Loss: 0.008366, Test Loss: 0.016408
Epoch [56/150], Train Loss: 0.017803, Val Loss: 0.009364, Test Loss: 0.022995
Epoch [57/150], Train Loss: 0.016337, Val Loss: 0.009199, Test Loss: 0.025863
Epoch [58/150], Train Loss: 0.016502, Val Loss: 0.009656, Test Loss: 0.015141
Epoch [59/150], Train Loss: 0.016344, Val Loss: 0.010076, Test Loss: 0.019872
Epoch [60/150], Train Loss: 0.026745, Val Loss: 0.027827, Test Loss: 0.031354
Epoch [61/150], Train Loss: 0.044647, Val Loss: 0.008943, Test Loss: 0.015449
Epoch [62/150], Train Loss: 0.016886, Val Loss: 0.025860, Test Loss: 0.027630
Epoch [63/150], Train Loss: 0.046611, Val Loss: 0.018109, Test Loss: 0.037534
Epoch [64/150], Train Loss: 0.028525, Val Loss: 0.013432, Test Loss: 0.030025
Epoch [65/150], Train Loss: 0.019723, Val Loss: 0.014349, Test Loss: 0.032993
Epoch [66/150], Train Loss: 0.018290, Val Loss: 0.012208, Test Loss: 0.015556
Epoch [67/150], Train Loss: 0.021789, Val Loss: 0.012654, Test Loss: 0.015911
Epoch [68/150], Train Loss: 0.021351, Val Loss: 0.008227, Test Loss: 0.016527
Epoch [69/150], Train Loss: 0.015240, Val Loss: 0.009231, Test Loss: 0.021698
早停于第69轮
实际预测天数: 365
短期预测 - MSE: 117365.8979, MAE: 272.7510
长期预测 - MSE: 169556.4452, MAE: 316.1166

=== 实验 5/5 ===
训练短期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=128, nhead=8, num_layers=3
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/100], Train Loss: 0.158849, Val Loss: 0.057085, Test Loss: 0.043666 *
Epoch [2/100], Train Loss: 0.061785, Val Loss: 0.037911, Test Loss: 0.025371 *
Epoch [3/100], Train Loss: 0.038876, Val Loss: 0.033400, Test Loss: 0.023309 *
Epoch [4/100], Train Loss: 0.038084, Val Loss: 0.037390, Test Loss: 0.030677
Epoch [5/100], Train Loss: 0.042929, Val Loss: 0.033011, Test Loss: 0.023557 *
Epoch [6/100], Train Loss: 0.045836, Val Loss: 0.041079, Test Loss: 0.025705
Epoch [7/100], Train Loss: 0.041673, Val Loss: 0.040949, Test Loss: 0.024968
Epoch [8/100], Train Loss: 0.041188, Val Loss: 0.032796, Test Loss: 0.019247 *
Epoch [9/100], Train Loss: 0.033289, Val Loss: 0.030584, Test Loss: 0.019108 *
Epoch [10/100], Train Loss: 0.030989, Val Loss: 0.033917, Test Loss: 0.024196
Epoch [11/100], Train Loss: 0.034017, Val Loss: 0.032036, Test Loss: 0.018885
Epoch [12/100], Train Loss: 0.031212, Val Loss: 0.030594, Test Loss: 0.018391
Epoch [13/100], Train Loss: 0.034357, Val Loss: 0.029565, Test Loss: 0.018284 *
Epoch [14/100], Train Loss: 0.042491, Val Loss: 0.040945, Test Loss: 0.027603
Epoch [15/100], Train Loss: 0.039158, Val Loss: 0.031872, Test Loss: 0.020476
Epoch [16/100], Train Loss: 0.036011, Val Loss: 0.058155, Test Loss: 0.045618
Epoch [17/100], Train Loss: 0.043143, Val Loss: 0.034141, Test Loss: 0.022413
Epoch [18/100], Train Loss: 0.032707, Val Loss: 0.032349, Test Loss: 0.022558
Epoch [19/100], Train Loss: 0.046203, Val Loss: 0.032901, Test Loss: 0.022253
Epoch [20/100], Train Loss: 0.048038, Val Loss: 0.034217, Test Loss: 0.023757
Epoch [21/100], Train Loss: 0.043800, Val Loss: 0.031393, Test Loss: 0.020387
Epoch [22/100], Train Loss: 0.030943, Val Loss: 0.030504, Test Loss: 0.019830
Epoch [23/100], Train Loss: 0.036943, Val Loss: 0.041805, Test Loss: 0.032586
Epoch [24/100], Train Loss: 0.037500, Val Loss: 0.025676, Test Loss: 0.017012 *
Epoch [25/100], Train Loss: 0.029155, Val Loss: 0.024924, Test Loss: 0.016410 *
Epoch [26/100], Train Loss: 0.032936, Val Loss: 0.028174, Test Loss: 0.020650
Epoch [27/100], Train Loss: 0.044671, Val Loss: 0.023591, Test Loss: 0.017886 *
Epoch [28/100], Train Loss: 0.025200, Val Loss: 0.034708, Test Loss: 0.029058
Epoch [29/100], Train Loss: 0.033891, Val Loss: 0.039504, Test Loss: 0.039628
Epoch [30/100], Train Loss: 0.036268, Val Loss: 0.022410, Test Loss: 0.017372 *
Epoch [31/100], Train Loss: 0.023961, Val Loss: 0.020217, Test Loss: 0.015621 *
Epoch [32/100], Train Loss: 0.029690, Val Loss: 0.019733, Test Loss: 0.014947 *
Epoch [33/100], Train Loss: 0.025310, Val Loss: 0.019325, Test Loss: 0.015418 *
Epoch [34/100], Train Loss: 0.021536, Val Loss: 0.018787, Test Loss: 0.015385 *
Epoch [35/100], Train Loss: 0.023067, Val Loss: 0.020948, Test Loss: 0.019969
Epoch [36/100], Train Loss: 0.022798, Val Loss: 0.017132, Test Loss: 0.016305 *
Epoch [37/100], Train Loss: 0.025986, Val Loss: 0.017817, Test Loss: 0.015777
Epoch [38/100], Train Loss: 0.022861, Val Loss: 0.018471, Test Loss: 0.016023
Epoch [39/100], Train Loss: 0.024156, Val Loss: 0.017423, Test Loss: 0.017208
Epoch [40/100], Train Loss: 0.022723, Val Loss: 0.016013, Test Loss: 0.016351 *
Epoch [41/100], Train Loss: 0.020330, Val Loss: 0.016674, Test Loss: 0.020417
Epoch [42/100], Train Loss: 0.021049, Val Loss: 0.018277, Test Loss: 0.018441
Epoch [43/100], Train Loss: 0.023448, Val Loss: 0.014506, Test Loss: 0.017437 *
Epoch [44/100], Train Loss: 0.021652, Val Loss: 0.016870, Test Loss: 0.017327
Epoch [45/100], Train Loss: 0.021130, Val Loss: 0.014820, Test Loss: 0.016969
Epoch [46/100], Train Loss: 0.020468, Val Loss: 0.014830, Test Loss: 0.016087
Epoch [47/100], Train Loss: 0.018346, Val Loss: 0.014038, Test Loss: 0.015774 *
Epoch [48/100], Train Loss: 0.019491, Val Loss: 0.016797, Test Loss: 0.016427
Epoch [49/100], Train Loss: 0.018422, Val Loss: 0.014641, Test Loss: 0.017713
Epoch [50/100], Train Loss: 0.021353, Val Loss: 0.016464, Test Loss: 0.016833
Epoch [51/100], Train Loss: 0.016651, Val Loss: 0.013608, Test Loss: 0.016405 *
Epoch [52/100], Train Loss: 0.018152, Val Loss: 0.013341, Test Loss: 0.016235 *
Epoch [53/100], Train Loss: 0.017654, Val Loss: 0.015397, Test Loss: 0.016784
Epoch [54/100], Train Loss: 0.017379, Val Loss: 0.013079, Test Loss: 0.019140 *
Epoch [55/100], Train Loss: 0.019648, Val Loss: 0.014562, Test Loss: 0.020803
Epoch [56/100], Train Loss: 0.017104, Val Loss: 0.014004, Test Loss: 0.016055
Epoch [57/100], Train Loss: 0.016059, Val Loss: 0.013856, Test Loss: 0.017063
Epoch [58/100], Train Loss: 0.016701, Val Loss: 0.013423, Test Loss: 0.016199
Epoch [59/100], Train Loss: 0.016686, Val Loss: 0.014061, Test Loss: 0.020001
Epoch [60/100], Train Loss: 0.016927, Val Loss: 0.012978, Test Loss: 0.018017 *
Epoch [61/100], Train Loss: 0.014788, Val Loss: 0.012784, Test Loss: 0.017443 *
Epoch [62/100], Train Loss: 0.015016, Val Loss: 0.013933, Test Loss: 0.017963
Epoch [63/100], Train Loss: 0.015425, Val Loss: 0.014366, Test Loss: 0.016117
Epoch [64/100], Train Loss: 0.016486, Val Loss: 0.013047, Test Loss: 0.017358
Epoch [65/100], Train Loss: 0.014177, Val Loss: 0.013458, Test Loss: 0.015953
Epoch [66/100], Train Loss: 0.015952, Val Loss: 0.012904, Test Loss: 0.016366
Epoch [67/100], Train Loss: 0.014981, Val Loss: 0.012488, Test Loss: 0.018439 *
Epoch [68/100], Train Loss: 0.015436, Val Loss: 0.012648, Test Loss: 0.018641
Epoch [69/100], Train Loss: 0.013698, Val Loss: 0.013516, Test Loss: 0.017217
Epoch [70/100], Train Loss: 0.013795, Val Loss: 0.013033, Test Loss: 0.017757
Epoch [71/100], Train Loss: 0.014268, Val Loss: 0.013772, Test Loss: 0.016762
Epoch [72/100], Train Loss: 0.013711, Val Loss: 0.014067, Test Loss: 0.016760
Epoch [73/100], Train Loss: 0.013969, Val Loss: 0.013945, Test Loss: 0.018157
Epoch [74/100], Train Loss: 0.012576, Val Loss: 0.013379, Test Loss: 0.019057
Epoch [75/100], Train Loss: 0.013346, Val Loss: 0.012652, Test Loss: 0.018112
Epoch [76/100], Train Loss: 0.012073, Val Loss: 0.013328, Test Loss: 0.017462
Epoch [77/100], Train Loss: 0.014350, Val Loss: 0.012991, Test Loss: 0.019859
Epoch [78/100], Train Loss: 0.012082, Val Loss: 0.013209, Test Loss: 0.018120
Epoch [79/100], Train Loss: 0.012036, Val Loss: 0.013375, Test Loss: 0.017463
Epoch [80/100], Train Loss: 0.012552, Val Loss: 0.013317, Test Loss: 0.020349
Epoch [81/100], Train Loss: 0.012723, Val Loss: 0.013156, Test Loss: 0.017756
Epoch [82/100], Train Loss: 0.011795, Val Loss: 0.013244, Test Loss: 0.017551
早停于第82轮
实际预测天数: 100
实际预测天数: 90
训练长期预测模型...

开始训练Transformer模型 (序列长度: 90)
模型参数: d_model=256, nhead=8, num_layers=5
总训练样本数量: 626
训练集样本数量: 563
验证集样本数量: 63
Epoch [1/150], Train Loss: 0.244551, Val Loss: 0.041885, Test Loss: 0.024678 *
Epoch [2/150], Train Loss: 0.054075, Val Loss: 0.030510, Test Loss: 0.023623 *
Epoch [3/150], Train Loss: 0.043653, Val Loss: 0.040983, Test Loss: 0.023598
Epoch [4/150], Train Loss: 0.036835, Val Loss: 0.029226, Test Loss: 0.020992 *
Epoch [5/150], Train Loss: 0.036335, Val Loss: 0.046323, Test Loss: 0.028259
Epoch [6/150], Train Loss: 0.036443, Val Loss: 0.028112, Test Loss: 0.018939 *
Epoch [7/150], Train Loss: 0.031286, Val Loss: 0.033326, Test Loss: 0.020610
Epoch [8/150], Train Loss: 0.029861, Val Loss: 0.025185, Test Loss: 0.018129 *
Epoch [9/150], Train Loss: 0.029465, Val Loss: 0.025634, Test Loss: 0.017819
Epoch [10/150], Train Loss: 0.029275, Val Loss: 0.050837, Test Loss: 0.033828
Epoch [11/150], Train Loss: 0.031158, Val Loss: 0.024240, Test Loss: 0.024833 *
Epoch [12/150], Train Loss: 0.052474, Val Loss: 0.034155, Test Loss: 0.022878
Epoch [13/150], Train Loss: 0.035195, Val Loss: 0.035379, Test Loss: 0.022271
Epoch [14/150], Train Loss: 0.034533, Val Loss: 0.024412, Test Loss: 0.022004
Epoch [15/150], Train Loss: 0.037055, Val Loss: 0.066271, Test Loss: 0.046536
Epoch [16/150], Train Loss: 0.032310, Val Loss: 0.026841, Test Loss: 0.019624
Epoch [17/150], Train Loss: 0.032972, Val Loss: 0.029138, Test Loss: 0.019821
Epoch [18/150], Train Loss: 0.033723, Val Loss: 0.023163, Test Loss: 0.017979 *
Epoch [19/150], Train Loss: 0.034973, Val Loss: 0.022833, Test Loss: 0.022149 *
Epoch [20/150], Train Loss: 0.032348, Val Loss: 0.033317, Test Loss: 0.022972
Epoch [21/150], Train Loss: 0.032744, Val Loss: 0.024791, Test Loss: 0.025655
Epoch [22/150], Train Loss: 0.050858, Val Loss: 0.023976, Test Loss: 0.022498
Epoch [23/150], Train Loss: 0.025899, Val Loss: 0.075112, Test Loss: 0.085156
Epoch [24/150], Train Loss: 0.043911, Val Loss: 0.023535, Test Loss: 0.021046
Epoch [25/150], Train Loss: 0.031267, Val Loss: 0.030575, Test Loss: 0.035510
Epoch [26/150], Train Loss: 0.034765, Val Loss: 0.017043, Test Loss: 0.015050 *
Epoch [27/150], Train Loss: 0.027282, Val Loss: 0.035505, Test Loss: 0.030832
Epoch [28/150], Train Loss: 0.029625, Val Loss: 0.015002, Test Loss: 0.015900 *
Epoch [29/150], Train Loss: 0.046595, Val Loss: 0.016748, Test Loss: 0.016656
Epoch [30/150], Train Loss: 0.026934, Val Loss: 0.012100, Test Loss: 0.014492 *
Epoch [31/150], Train Loss: 0.023901, Val Loss: 0.011230, Test Loss: 0.014957 *
Epoch [32/150], Train Loss: 0.020812, Val Loss: 0.012242, Test Loss: 0.015850
Epoch [33/150], Train Loss: 0.020224, Val Loss: 0.013921, Test Loss: 0.017511
Epoch [34/150], Train Loss: 0.024132, Val Loss: 0.020164, Test Loss: 0.022117
Epoch [35/150], Train Loss: 0.028100, Val Loss: 0.013456, Test Loss: 0.016602
Epoch [36/150], Train Loss: 0.020437, Val Loss: 0.041910, Test Loss: 0.044674
Epoch [37/150], Train Loss: 0.021962, Val Loss: 0.020668, Test Loss: 0.017931
Epoch [38/150], Train Loss: 0.026652, Val Loss: 0.011979, Test Loss: 0.014443
Epoch [39/150], Train Loss: 0.020812, Val Loss: 0.012046, Test Loss: 0.015956
Epoch [40/150], Train Loss: 0.019271, Val Loss: 0.013112, Test Loss: 0.018741
Epoch [41/150], Train Loss: 0.020722, Val Loss: 0.013838, Test Loss: 0.018984
Epoch [42/150], Train Loss: 0.032553, Val Loss: 0.013892, Test Loss: 0.017650
Epoch [43/150], Train Loss: 0.056110, Val Loss: 0.018783, Test Loss: 0.023328
Epoch [44/150], Train Loss: 0.046405, Val Loss: 0.021221, Test Loss: 0.020463
Epoch [45/150], Train Loss: 0.128051, Val Loss: 0.204658, Test Loss: 0.188912
Epoch [46/150], Train Loss: 0.057854, Val Loss: 0.012005, Test Loss: 0.015989
早停于第46轮
实际预测天数: 365
短期预测 - MSE: 140767.6348, MAE: 282.8058
长期预测 - MSE: 223041.5157, MAE: 374.4025

=== 实验结果汇总（含集成模型）===

短期预测结果:
MSE: 150727.8178 ± 20303.8121
MAE: 311.2056 ± 28.8488

长期预测结果:
MSE: 153264.4198 ± 0.0000
MAE: 302.3533 ± 0.0000

Error Statistics:
Short-Term Prediction - Mean Error: 42.60 kW, Standard Deviation: 392.41 kW
Long-Term Prediction - Mean Error: -82.35 kW, Standard Deviation: 382.73 kW

实验完成！优化结果图片已保存为:
- enhanced_transformer_prediction_results.png
- enhanced_transformer_error_analysis.png
预测误差数据已保存为: prediction_errors.csv


短期预测统计结果:
MSE均值: 150727.8178, MSE标准差: 20303.8121
MAE均值: 311.2056, MAE标准差: 28.8488
长期预测统计结果:
MSE均值: 193166.0479, MSE标准差: 19830.9421
MAE均值: 341.7617, MAE标准差: 21.3587